!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o={SCRIPT_ID:"1D2hRx_8oVLxxZ86e0kNGSU9AJzWXqe0kFjQotyKJYYI_dn6mrgoKh9KH",CLIENT_ID:"120774100761-kglgrp4khpcjrpfvgbn7vqoqfcpnkvep.apps.googleusercontent.com",API_KEY:"AIzaSyCFsUU7845Cf03LtAFBkpOWezSejhSGF8U",DISCOVERY_DOCS:["https://script.googleapis.com/$discovery/rest?version=v1"],SCOPES:"https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/spreadsheets"};function a(){}a.registerListeners=function(e,t){a.SIGNIN_STATUS_LISTENER=e,a.CURRENT_USER_LISTENER=t},a.load=function(e,t,n,o,i){a.SCRIPT_ID=e,a.CLIENT_ID=t,a.API_KEY=n,a.DISCOVERY_DOCS=o,a.SCOPES=i,gapi.load("client:auth2",a.initClient)},a.initClient=function(){gapi.client.init({apiKey:a.API_KEY,clientId:a.CLIENT_ID,discoveryDocs:a.DISCOVERY_DOCS,scope:a.SCOPES}).then(function(){void 0!==a.SIGNIN_STATUS_LISTENER&&(gapi.auth2.getAuthInstance().isSignedIn.listen(a.SIGNIN_STATUS_LISTENER),a.SIGNIN_STATUS_LISTENER(gapi.auth2.getAuthInstance().isSignedIn.get())),void 0!==a.CURRENT_USER_LISTENER&&(gapi.auth2.getAuthInstance().currentUser.listen(a.CURRENT_USER_LISTENER),a.CURRENT_USER_LISTENER(gapi.auth2.getAuthInstance().currentUser.get()))})},a.signIn=function(){gapi.auth2.getAuthInstance().signIn()},a.signOut=function(){gapi.auth2.getAuthInstance().signOut()},a.runScript=function(e,t,n,o){gapi.client.script.scripts.run({scriptId:a.SCRIPT_ID,resource:{function:e,parameters:t,devMode:!0}}).then(function(e){var t=e.result;if(t.error&&t.error.status)var a="Error calling API:\n"+JSON.stringify(t,null,2);else if(t.error){var i=t.error.details[0];a=i.errorMessage;if(console.error("Script error message: "+a),i.scriptStackTraceElements){console.error("Script error stacktrace:");for(var r=0;r<i.scriptStackTraceElements.length;r++){var s=i.scriptStackTraceElements[r];console.error("\t"+s.function+":"+s.lineNumber)}}o(a)}else n(t.response.result)})};var i=!1,r=1e3,s={girl:{key:"girl",name:"Isabelle",css:"css/girl/bootstrap.min.css",icon:"flaticon-baby-girl",background:"images/girl/background.png"},boy:{key:"boy",name:"Ethan",css:"css/boy/bootstrap.min.css",icon:"flaticon-baby",background:"images/boy/background.png"}},c=s.girl,l={templates:{}};function u(e){e=e||s.boy,Cookies.set("theme",e.key),c=e,$("#babyIcon").removeClass(),$("#babyIcon").addClass(e.icon),$("#babyName").text(e.name),$("#themeLink").attr("href",e.css),$("#backgroundImg").attr("src",e.background)}function d(e){e?($("#signInModal").modal("hide"),$("#signInSection").hide(),$("#currentUserSection").show(),$("#signedInView").show(),p()):($("#signInModal").modal("show"),$("#signInSection").show(),$("#currentUserSection").hide(),$("#signedInView").hide())}function g(e){var t=e.isSignedIn()?e.getBasicProfile().getEmail():"";$("#currentUser").text(t)}function p(){S("Loading..."),i?setTimeout(function(){f({dashboard:sampleDashboardContext,today:sampleTodayContext,yesterday:sampleYesterdayContext})},r):a.runScript("loadData",[c.name],f,b)}function f(e){m("#dashboard-template","#dashboard",e.dashboard),m("#today-template","#today",e.today),m("#yesterday-template","#yesterday",e.yesterday),I()}function m(e,t,n){void 0===l.templates[e]&&(l.templates[e]=$(e).html());var o=Handlebars.compile(l.templates[e])(n);$(t).html(o)}function S(e){$("#overlay-text").text(e),$("#wait").css("display","block")}function I(){$("#wait").css("display","none")}function b(e){I(),alert(e),$("#submitBtn").val("Submit")}function h(){$("#submitBtn").val("Submit"),I(),p()}function v(){console.log("resetForm");var e=6e4*(new Date).getTimezoneOffset(),t=new Date(Date.now()-e).toISOString().slice(0,-1);t.slice(0,16);$("#date").val(t.slice(0,16)),$("#amount").val(""),$("#type").val(""),$("#time").val(""),$("#meal").val(""),$("#vitamin-no").click(),$("#wet-no").click(),$("#dirty-no").click(),$("#weight").val(""),$("#notes").val(""),$("#bath-no").click()}$(function(){console.log("Loading page"),a.registerListeners(d,g),a.load(o.SCRIPT_ID,o.CLIENT_ID,o.API_KEY,o.DISCOVERY_DOCS,o.SCOPES),$("#weight").mask("#0.00",{reverse:!1,placeholder:"__.__"});var e=Cookies.get("theme");u(s[e]),function(){var e=$("#day-partial").html(),t=Handlebars.compile(e);Handlebars.registerPartial("dayPartial",t)}(),$("#myForm").submit(function(e){e.preventDefault(),function(e){$("#addNewModal").modal("hide"),S("Saving..."),console.log("running script");var t=function(e){var t={};$("#"+e.id+" :input").each(function(){("radio"===this.type&&!0===this.checked||"radio"!==this.type)&&(t[this.name]=$(this).val())}),t.baby=c.name,"Solids"!==t["feeding-type"]&&delete t.meal;"Bottle"!==t["feeding-type"]&&(delete t.amount,delete t.type);"Breast"!==t["feeding-type"]&&(delete t.time,delete t.side);return console.log(t),t}(e);i?setTimeout(function(){h()},r):a.runScript("submitForm",t,h,b)}(this)}),$(".navbar-nav>.nav-close>a").on("click",function(){$(".navbar-collapse").collapse("hide")}),$(".navbar-collapse>div>button").on("click",function(){$(".navbar-collapse").collapse("hide")}),$(".signIn").on("click",function(){a.signIn()}),$("#signOut").on("click",function(){a.signOut()}),$(".navbar-nav>.dropdown>div>a").on("click",function(){u(s[$(this).attr("data-baby")]),$(".navbar-collapse").collapse("hide"),p()}),$("#addNewModal").on("show.bs.modal",function(e){v()}),$("#addNewModal").on("hidden.bs.modal",function(e){v()})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2tleXMuanMiLCJ3ZWJwYWNrOi8vLy4uL19jb21tb24vanMvZ29vZ2xlLmpzIiwid2VicGFjazovLy8uL3NyYy9zY3JpcHQuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJHT09HTEVfSURTIiwiU0NSSVBUX0lEIiwiQ0xJRU5UX0lEIiwiQVBJX0tFWSIsIkRJU0NPVkVSWV9ET0NTIiwiU0NPUEVTIiwiR29vZ2xlQVBJV3JhcHBlciIsInJlZ2lzdGVyTGlzdGVuZXJzIiwic2lnbkluU3RhdHVzTGlzdGVuZXIiLCJjdXJyZW50VXNlckxpc3RlbmVyIiwiU0lHTklOX1NUQVRVU19MSVNURU5FUiIsIkNVUlJFTlRfVVNFUl9MSVNURU5FUiIsImxvYWQiLCJzY3JpcHRJZCIsImNsaWVudElkIiwiYXBpS2V5IiwiZGlzY292ZXJ5RG9jcyIsInNjb3BlcyIsImdhcGkiLCJpbml0Q2xpZW50IiwiY2xpZW50IiwiaW5pdCIsInNjb3BlIiwidGhlbiIsInVuZGVmaW5lZCIsImF1dGgyIiwiZ2V0QXV0aEluc3RhbmNlIiwiaXNTaWduZWRJbiIsImxpc3RlbiIsImN1cnJlbnRVc2VyIiwic2lnbkluIiwic2lnbk91dCIsInJ1blNjcmlwdCIsImZ1bmN0aW9uTmFtZSIsInBhcmFtZXRlcnMiLCJzdWNjZXNzQ2FsbGJhY2siLCJmYWlsdXJlQ2FsbGJhY2siLCJzY3JpcHQiLCJzY3JpcHRzIiwicnVuIiwicmVzb3VyY2UiLCJmdW5jdGlvbiIsImRldk1vZGUiLCJyZXNwIiwicmVzdWx0IiwiZXJyb3IiLCJzdGF0dXMiLCJtZXNzYWdlIiwiSlNPTiIsInN0cmluZ2lmeSIsImRldGFpbHMiLCJlcnJvck1lc3NhZ2UiLCJjb25zb2xlIiwic2NyaXB0U3RhY2tUcmFjZUVsZW1lbnRzIiwibGVuZ3RoIiwidHJhY2UiLCJsaW5lTnVtYmVyIiwicmVzcG9uc2UiLCJERUJVRyIsIkRFTEFZIiwiX3RoZW1lcyIsImdpcmwiLCJjc3MiLCJpY29uIiwiYmFja2dyb3VuZCIsImJveSIsIl9jdXJyZW50VGhlbWUiLCJfSGFuZGxlYmFycyIsInRlbXBsYXRlcyIsInNldFRoZW1lIiwidGhlbWUiLCJDb29raWVzIiwic2V0IiwiJCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJ0ZXh0IiwiYXR0ciIsInVwZGF0ZVNpZ25pblN0YXR1cyIsIm1vZGFsIiwiaGlkZSIsInNob3ciLCJsb2FkRGF0YSIsInVwZGF0ZUN1cnJlbnRVc2VyIiwiZW1haWwiLCJnZXRCYXNpY1Byb2ZpbGUiLCJnZXRFbWFpbCIsIm9wZW5PdmVybGF5Iiwic2V0VGltZW91dCIsImxvYWRIYW5kbGViYXJzIiwiZGFzaGJvYXJkIiwic2FtcGxlRGFzaGJvYXJkQ29udGV4dCIsInRvZGF5Iiwic2FtcGxlVG9kYXlDb250ZXh0IiwieWVzdGVyZGF5Iiwic2FtcGxlWWVzdGVyZGF5Q29udGV4dCIsIm9uRmFpbHVyZSIsImRhdGEiLCJkaXNwbGF5VGVtcGxhdGUiLCJjbG9zZU92ZXJsYXkiLCJ0ZW1wbGF0ZUlkIiwic2VjdGlvbiIsImNvbnRleHQiLCJodG1sIiwiSGFuZGxlYmFycyIsImNvbXBpbGUiLCJ0ZW1wbGF0ZSIsIm92ZXJsYXlUZXh0IiwiYWxlcnQiLCJ2YWwiLCJvblN1Ym1pdEZvcm1TdWNjZXNzIiwicmVzZXRGb3JtIiwibG9nIiwidHpvZmZzZXQiLCJEYXRlIiwiZ2V0VGltZXpvbmVPZmZzZXQiLCJsb2NhbElTT1RpbWUiLCJub3ciLCJ0b0lTT1N0cmluZyIsInNsaWNlIiwiY2xpY2siLCJtYXNrIiwicmV2ZXJzZSIsInBsYWNlaG9sZGVyIiwidGhlbWVLZXkiLCJwYXJ0aWFsIiwicmVnaXN0ZXJQYXJ0aWFsIiwicmVnaXN0ZXJEYXlQYXJ0aWFsIiwic3VibWl0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm1PYmplY3QiLCJ2YWx1ZXMiLCJmb3JtIiwiaWQiLCJlYWNoIiwidGhpcyIsInR5cGUiLCJjaGVja2VkIiwiZ2V0Rm9ybVZhbHVlcyIsImhhbmRsZUZvcm1TdWJtaXQiLCJvbiIsImNvbGxhcHNlIiwiZSJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxhQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFB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QXBFLEVBQUEsb0JBQUFxRSxTQUFBLFVBSUFyRSxFQUFBLFdBQUFvRSxHQUFBLG1CQUNBdkksRUFBQXdCLFdBR0EyQyxFQUFBLFlBQUFvRSxHQUFBLG1CQUNBdkksRUFBQXlCLFlBSUEwQyxFQUFBLCtCQUFBb0UsR0FBQSxtQkFDQXhFLEVBQUFULEVBQUFhLEVBQUErRCxNQUFBM0QsS0FBQSxlQUNBSixFQUFBLG9CQUFBcUUsU0FBQSxRQUVBNUQsTUFJQVQsRUFBQSxnQkFBQW9FLEdBQUEseUJBQUFFLEdBQ0FoQyxNQUdBdEMsRUFBQSxnQkFBQW9FLEdBQUEsMkJBQUFFLEdBQ0FoQyIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJ2YXIgR09PR0xFX0lEUyA9IHtcclxuICAgIFNDUklQVF9JRDogXCIxRDJoUnhfOG9WTHh4Wjg2ZTBrTkdTVTlBSnpXWHFlMGtGalFvdHlLSllZSV9kbjZtcmdvS2g5S0hcIixcclxuICAgIENMSUVOVF9JRDogXCIxMjA3NzQxMDA3NjEta2dsZ3JwNGtocGNqcnBmdmdibjd2cW9xZmNwbmt2ZXAuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb21cIixcclxuICAgIEFQSV9LRVk6IFwiQUl6YVN5Q0ZzVVU3ODQ1Q2YwM0x0QUZCa3BPV2V6U2VqaFNHRjhVXCIsXHJcbiAgICBESVNDT1ZFUllfRE9DUzogW1wiaHR0cHM6Ly9zY3JpcHQuZ29vZ2xlYXBpcy5jb20vJGRpc2NvdmVyeS9yZXN0P3ZlcnNpb249djFcIl0sXHJcbiAgICBTQ09QRVM6IFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9kcml2ZSBodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL3NwcmVhZHNoZWV0c1wiXHJcbn07XHJcblxyXG5leHBvcnQge1xyXG4gICAgR09PR0xFX0lEU1xyXG59O1xyXG4iLCJmdW5jdGlvbiBHb29nbGVBUElXcmFwcGVyKCkge31cclxuXHJcbkdvb2dsZUFQSVdyYXBwZXIucmVnaXN0ZXJMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoc2lnbkluU3RhdHVzTGlzdGVuZXIsIGN1cnJlbnRVc2VyTGlzdGVuZXIpIHtcclxuICAgIEdvb2dsZUFQSVdyYXBwZXIuU0lHTklOX1NUQVRVU19MSVNURU5FUiA9IHNpZ25JblN0YXR1c0xpc3RlbmVyO1xyXG4gICAgR29vZ2xlQVBJV3JhcHBlci5DVVJSRU5UX1VTRVJfTElTVEVORVIgPSBjdXJyZW50VXNlckxpc3RlbmVyO1xyXG59O1xyXG5cclxuR29vZ2xlQVBJV3JhcHBlci5sb2FkID0gZnVuY3Rpb24gKHNjcmlwdElkLCBjbGllbnRJZCwgYXBpS2V5LCBkaXNjb3ZlcnlEb2NzLCBzY29wZXMpIHtcclxuICAgIEdvb2dsZUFQSVdyYXBwZXIuU0NSSVBUX0lEID0gc2NyaXB0SWQ7XHJcbiAgICBHb29nbGVBUElXcmFwcGVyLkNMSUVOVF9JRCA9IGNsaWVudElkO1xyXG4gICAgR29vZ2xlQVBJV3JhcHBlci5BUElfS0VZID0gYXBpS2V5O1xyXG4gICAgR29vZ2xlQVBJV3JhcHBlci5ESVNDT1ZFUllfRE9DUyA9IGRpc2NvdmVyeURvY3M7XHJcbiAgICBHb29nbGVBUElXcmFwcGVyLlNDT1BFUyA9IHNjb3BlczsgLy8gQXV0aG9yaXphdGlvbiBzY29wZXMgcmVxdWlyZWQgYnkgdGhlIEFQSTsgbXVsdGlwbGUgc2NvcGVzIGNhbiBiZSBpbmNsdWRlZCwgc2VwYXJhdGVkIGJ5IHNwYWNlcy5cclxuXHJcbiAgICBnYXBpLmxvYWQoJ2NsaWVudDphdXRoMicsIEdvb2dsZUFQSVdyYXBwZXIuaW5pdENsaWVudCk7XHJcbn07XHJcblxyXG5Hb29nbGVBUElXcmFwcGVyLmluaXRDbGllbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBnYXBpLmNsaWVudC5pbml0KHtcclxuICAgICAgICBhcGlLZXk6IEdvb2dsZUFQSVdyYXBwZXIuQVBJX0tFWSxcclxuICAgICAgICBjbGllbnRJZDogR29vZ2xlQVBJV3JhcHBlci5DTElFTlRfSUQsXHJcbiAgICAgICAgZGlzY292ZXJ5RG9jczogR29vZ2xlQVBJV3JhcHBlci5ESVNDT1ZFUllfRE9DUyxcclxuICAgICAgICBzY29wZTogR29vZ2xlQVBJV3JhcHBlci5TQ09QRVNcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIExpc3RlbiBmb3Igc2lnbi1pbiBzdGF0ZSBjaGFuZ2VzLlxyXG4gICAgICAgIGlmIChHb29nbGVBUElXcmFwcGVyLlNJR05JTl9TVEFUVVNfTElTVEVORVIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBnYXBpLmF1dGgyLmdldEF1dGhJbnN0YW5jZSgpLmlzU2lnbmVkSW4ubGlzdGVuKEdvb2dsZUFQSVdyYXBwZXIuU0lHTklOX1NUQVRVU19MSVNURU5FUik7XHJcblxyXG4gICAgICAgICAgICAvLyBIYW5kbGUgdGhlIGluaXRpYWwgc2lnbi1pbiBzdGF0ZS5cclxuICAgICAgICAgICAgR29vZ2xlQVBJV3JhcHBlci5TSUdOSU5fU1RBVFVTX0xJU1RFTkVSKGdhcGkuYXV0aDIuZ2V0QXV0aEluc3RhbmNlKCkuaXNTaWduZWRJbi5nZXQoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoR29vZ2xlQVBJV3JhcHBlci5DVVJSRU5UX1VTRVJfTElTVEVORVIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBnYXBpLmF1dGgyLmdldEF1dGhJbnN0YW5jZSgpLmN1cnJlbnRVc2VyLmxpc3RlbihHb29nbGVBUElXcmFwcGVyLkNVUlJFTlRfVVNFUl9MSVNURU5FUik7XHJcbiAgICAgICAgICAgIEdvb2dsZUFQSVdyYXBwZXIuQ1VSUkVOVF9VU0VSX0xJU1RFTkVSKGdhcGkuYXV0aDIuZ2V0QXV0aEluc3RhbmNlKCkuY3VycmVudFVzZXIuZ2V0KCkpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuR29vZ2xlQVBJV3JhcHBlci5zaWduSW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBnYXBpLmF1dGgyLmdldEF1dGhJbnN0YW5jZSgpLnNpZ25JbigpO1xyXG59O1xyXG5cclxuR29vZ2xlQVBJV3JhcHBlci5zaWduT3V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgZ2FwaS5hdXRoMi5nZXRBdXRoSW5zdGFuY2UoKS5zaWduT3V0KCk7XHJcbn07XHJcblxyXG5Hb29nbGVBUElXcmFwcGVyLnJ1blNjcmlwdCA9IGZ1bmN0aW9uIChmdW5jdGlvbk5hbWUsIHBhcmFtZXRlcnMsIHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKSB7XHJcbiAgICAvLyBDYWxsIHRoZSBBcHBzIFNjcmlwdCBBUEkgcnVuIG1ldGhvZFxyXG4gICAgZ2FwaS5jbGllbnQuc2NyaXB0LnNjcmlwdHMucnVuKHtcclxuICAgICAgICAnc2NyaXB0SWQnOiBHb29nbGVBUElXcmFwcGVyLlNDUklQVF9JRCxcclxuICAgICAgICAncmVzb3VyY2UnOiB7XHJcbiAgICAgICAgICAgICdmdW5jdGlvbic6IGZ1bmN0aW9uTmFtZSxcclxuICAgICAgICAgICAgJ3BhcmFtZXRlcnMnOiBwYXJhbWV0ZXJzLFxyXG4gICAgICAgICAgICAnZGV2TW9kZSc6IHRydWVcclxuICAgICAgICB9XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHJlc3AucmVzdWx0O1xyXG4gICAgICAgIGlmIChyZXN1bHQuZXJyb3IgJiYgcmVzdWx0LmVycm9yLnN0YXR1cykge1xyXG4gICAgICAgICAgICAvLyBUaGUgQVBJIGVuY291bnRlcmVkIGEgcHJvYmxlbSBiZWZvcmUgdGhlIHNjcmlwdFxyXG4gICAgICAgICAgICAvLyBzdGFydGVkIGV4ZWN1dGluZy5cclxuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSAnRXJyb3IgY2FsbGluZyBBUEk6XFxuJyArIEpTT04uc3RyaW5naWZ5KHJlc3VsdCwgbnVsbCwgMik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuZXJyb3IpIHtcclxuICAgICAgICAgICAgLy8gVGhlIEFQSSBleGVjdXRlZCwgYnV0IHRoZSBzY3JpcHQgcmV0dXJuZWQgYW4gZXJyb3IuXHJcblxyXG4gICAgICAgICAgICAvLyBFeHRyYWN0IHRoZSBmaXJzdCAoYW5kIG9ubHkpIHNldCBvZiBlcnJvciBkZXRhaWxzLlxyXG4gICAgICAgICAgICAvLyBUaGUgdmFsdWVzIG9mIHRoaXMgb2JqZWN0IGFyZSB0aGUgc2NyaXB0J3MgJ2Vycm9yTWVzc2FnZScgYW5kXHJcbiAgICAgICAgICAgIC8vICdlcnJvclR5cGUnLCBhbmQgYW4gYXJyYXkgb2Ygc3RhY2sgdHJhY2UgZWxlbWVudHMuXHJcbiAgICAgICAgICAgIHZhciBlcnJvciA9IHJlc3VsdC5lcnJvci5kZXRhaWxzWzBdO1xyXG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGVycm9yLmVycm9yTWVzc2FnZTtcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NjcmlwdCBlcnJvciBtZXNzYWdlOiAnICsgbWVzc2FnZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZXJyb3Iuc2NyaXB0U3RhY2tUcmFjZUVsZW1lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGVyZSBtYXkgbm90IGJlIGEgc3RhY2t0cmFjZSBpZiB0aGUgc2NyaXB0IGRpZG4ndCBzdGFydFxyXG4gICAgICAgICAgICAgICAgLy8gZXhlY3V0aW5nLlxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignU2NyaXB0IGVycm9yIHN0YWNrdHJhY2U6Jyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVycm9yLnNjcmlwdFN0YWNrVHJhY2VFbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFjZSA9IGVycm9yLnNjcmlwdFN0YWNrVHJhY2VFbGVtZW50c1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdcXHQnICsgdHJhY2UuZnVuY3Rpb24rJzonICsgdHJhY2UubGluZU51bWJlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZhaWx1cmVDYWxsYmFjayhtZXNzYWdlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBUaGUgQVBJIHdhcyBzdWNjZXNzZnVsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQucmVzcG9uc2UucmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgICBHb29nbGVBUElXcmFwcGVyXHJcbn07XHJcbiIsImltcG9ydCB7XHJcbiAgICBHT09HTEVfSURTXHJcbn1cclxuZnJvbSAnLi9rZXlzJztcclxuXHJcbmltcG9ydCB7XHJcbiAgICBHb29nbGVBUElXcmFwcGVyXHJcbn1cclxuZnJvbSAnLi4vLi4vX2NvbW1vbi9qcy9nb29nbGUnO1xyXG5cclxuLy8tLS0tLSBEZWJ1ZyBWYXJpYWJsZXMgLS0tLS0vL1xyXG52YXIgREVCVUcgPSBmYWxzZTtcclxudmFyIERFTEFZID0gMTAwMDtcclxuXHJcbi8vLS0tLS0gTWV0aG9kcyBmb3IgR29vZ2xlIEZvcm1zIC0tLS0tLy9cclxuXHJcbi8vIFByZXZlbnQgZm9ybXMgZnJvbSBzdWJtaXR0aW5nLlxyXG4vL2Z1bmN0aW9uIHByZXZlbnRGb3JtU3VibWl0KCkge1xyXG4vLyAgICBjb25zb2xlLmxvZyhcInByZXZlbnRGb3JtU3VibWl0XCIpO1xyXG4vL1xyXG4vLyAgICB2YXIgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdmb3JtJyk7XHJcbi8vICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZm9ybXMubGVuZ3RoOyBpKyspIHtcclxuLy8gICAgICAgIGZvcm1zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4vLyAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic3VibWl0RXZlbnRcIik7XHJcbi8vXHJcbi8vICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuLy8gICAgICAgIH0pO1xyXG4vLyAgICB9XHJcbi8vfVxyXG4vL3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgcHJldmVudEZvcm1TdWJtaXQpO1xyXG5cclxuLy8tLS0tLSBUaGVtZXMgLS0tLS0vL1xyXG52YXIgX3RoZW1lcyA9IHtcclxuICAgIGdpcmw6IHtcclxuICAgICAgICBrZXk6IFwiZ2lybFwiLFxyXG4gICAgICAgIG5hbWU6IFwiSXNhYmVsbGVcIixcclxuICAgICAgICBjc3M6IFwiY3NzL2dpcmwvYm9vdHN0cmFwLm1pbi5jc3NcIixcclxuICAgICAgICBpY29uOiBcImZsYXRpY29uLWJhYnktZ2lybFwiLFxyXG4gICAgICAgIGJhY2tncm91bmQ6IFwiaW1hZ2VzL2dpcmwvYmFja2dyb3VuZC5wbmdcIlxyXG4gICAgfSxcclxuICAgIGJveToge1xyXG4gICAgICAgIGtleTogXCJib3lcIixcclxuICAgICAgICBuYW1lOiBcIkV0aGFuXCIsXHJcbiAgICAgICAgY3NzOiBcImNzcy9ib3kvYm9vdHN0cmFwLm1pbi5jc3NcIixcclxuICAgICAgICBpY29uOiBcImZsYXRpY29uLWJhYnlcIixcclxuICAgICAgICBiYWNrZ3JvdW5kOiBcImltYWdlcy9ib3kvYmFja2dyb3VuZC5wbmdcIlxyXG4gICAgfVxyXG59XHJcblxyXG52YXIgX2N1cnJlbnRUaGVtZSA9IF90aGVtZXMuZ2lybDtcclxuXHJcbi8vLS0tLS0gSGFuZGxlYmFycyBUZW1wbGF0ZXMgLS0tLS0vL1xyXG52YXIgX0hhbmRsZWJhcnMgPSB7XHJcbiAgICB0ZW1wbGF0ZXM6IHt9XHJcbn07XHJcblxyXG4vLy0tLS0tIE9uTG9hZCAtLS0tLS8vXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc29sZS5sb2coXCJMb2FkaW5nIHBhZ2VcIik7XHJcblxyXG4gICAgb25Hb29nbGVBcGlzTG9hZCgpO1xyXG5cclxuICAgICQoJyN3ZWlnaHQnKS5tYXNrKFwiIzAuMDBcIiwge1xyXG4gICAgICAgIHJldmVyc2U6IGZhbHNlLFxyXG4gICAgICAgIHBsYWNlaG9sZGVyOiBcIl9fLl9fXCJcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciB0aGVtZUtleSA9IENvb2tpZXMuZ2V0KCd0aGVtZScpO1xyXG4gICAgc2V0VGhlbWUoX3RoZW1lc1t0aGVtZUtleV0pO1xyXG5cclxuICAgIHJlZ2lzdGVyRGF5UGFydGlhbCgpO1xyXG5cclxuICAgIC8vLS0tLS0gRm9ybSBTdWJtaXQgLS0tLS0vL1xyXG4gICAgJChcIiNteUZvcm1cIikuc3VibWl0KGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIGhhbmRsZUZvcm1TdWJtaXQodGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLy0tLS0tIENvbGxhcHNlIG5hdmJhciBvbiBjbGljayAtLS0tLS8vXHJcbiAgICAkKCcubmF2YmFyLW5hdj4ubmF2LWNsb3NlPmEnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJCgnLm5hdmJhci1jb2xsYXBzZScpLmNvbGxhcHNlKCdoaWRlJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcubmF2YmFyLWNvbGxhcHNlPmRpdj5idXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJCgnLm5hdmJhci1jb2xsYXBzZScpLmNvbGxhcHNlKCdoaWRlJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLy0tLS0tIEF1dGhlbnRpY2F0aW9uIEJ1dHRvbiBFdmVudHMgLS0tLS0vL1xyXG4gICAgJChcIi5zaWduSW5cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgR29vZ2xlQVBJV3JhcHBlci5zaWduSW4oKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoXCIjc2lnbk91dFwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBHb29nbGVBUElXcmFwcGVyLnNpZ25PdXQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vLS0tLS0gU3dpdGNoIC0tLS0tLy9cclxuICAgICQoXCIubmF2YmFyLW5hdj4uZHJvcGRvd24+ZGl2PmFcIikub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNldFRoZW1lKF90aGVtZXNbJCh0aGlzKS5hdHRyKFwiZGF0YS1iYWJ5XCIpXSk7XHJcbiAgICAgICAgJCgnLm5hdmJhci1jb2xsYXBzZScpLmNvbGxhcHNlKCdoaWRlJyk7XHJcblxyXG4gICAgICAgIGxvYWREYXRhKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLy0tLS0tIE1vZGFsIEV2ZW50cyAtLS0tLS8vXHJcbiAgICAkKCcjYWRkTmV3TW9kYWwnKS5vbignc2hvdy5icy5tb2RhbCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgcmVzZXRGb3JtKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjYWRkTmV3TW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICByZXNldEZvcm0oKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbi8vLS0gU2V0IFRoZW1lIC0tLy9cclxuZnVuY3Rpb24gc2V0VGhlbWUodGhlbWUpIHtcclxuICAgIHRoZW1lID0gdGhlbWUgfHwgX3RoZW1lcy5ib3k7XHJcblxyXG4gICAgQ29va2llcy5zZXQoJ3RoZW1lJywgdGhlbWUua2V5KTtcclxuICAgIF9jdXJyZW50VGhlbWUgPSB0aGVtZTtcclxuXHJcbiAgICAkKFwiI2JhYnlJY29uXCIpLnJlbW92ZUNsYXNzKCk7XHJcbiAgICAkKFwiI2JhYnlJY29uXCIpLmFkZENsYXNzKHRoZW1lLmljb24pO1xyXG5cclxuICAgICQoXCIjYmFieU5hbWVcIikudGV4dCh0aGVtZS5uYW1lKTtcclxuXHJcbiAgICAkKFwiI3RoZW1lTGlua1wiKS5hdHRyKFwiaHJlZlwiLCB0aGVtZS5jc3MpO1xyXG5cclxuICAgICQoXCIjYmFja2dyb3VuZEltZ1wiKS5hdHRyKCdzcmMnLCB0aGVtZS5iYWNrZ3JvdW5kKTtcclxufVxyXG5cclxuLy8tLSBHb29nbGUgQVBJIE1ldGhvZHMgLS0vL1xyXG5mdW5jdGlvbiBvbkdvb2dsZUFwaXNMb2FkKCkge1xyXG4gICAgR29vZ2xlQVBJV3JhcHBlci5yZWdpc3Rlckxpc3RlbmVycyh1cGRhdGVTaWduaW5TdGF0dXMsIHVwZGF0ZUN1cnJlbnRVc2VyKTtcclxuXHJcbiAgICBHb29nbGVBUElXcmFwcGVyLmxvYWQoR09PR0xFX0lEUy5TQ1JJUFRfSUQsIEdPT0dMRV9JRFMuQ0xJRU5UX0lELCBHT09HTEVfSURTLkFQSV9LRVksIEdPT0dMRV9JRFMuRElTQ09WRVJZX0RPQ1MsIEdPT0dMRV9JRFMuU0NPUEVTKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlU2lnbmluU3RhdHVzKGlzU2lnbmVkSW4pIHtcclxuICAgIGlmIChpc1NpZ25lZEluKSB7XHJcbiAgICAgICAgJChcIiNzaWduSW5Nb2RhbFwiKS5tb2RhbChcImhpZGVcIik7XHJcbiAgICAgICAgJChcIiNzaWduSW5TZWN0aW9uXCIpLmhpZGUoKTtcclxuXHJcbiAgICAgICAgJChcIiNjdXJyZW50VXNlclNlY3Rpb25cIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjc2lnbmVkSW5WaWV3XCIpLnNob3coKTtcclxuXHJcbiAgICAgICAgbG9hZERhdGEoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJChcIiNzaWduSW5Nb2RhbFwiKS5tb2RhbChcInNob3dcIik7XHJcbiAgICAgICAgJChcIiNzaWduSW5TZWN0aW9uXCIpLnNob3coKTtcclxuXHJcbiAgICAgICAgJChcIiNjdXJyZW50VXNlclNlY3Rpb25cIikuaGlkZSgpO1xyXG4gICAgICAgICQoXCIjc2lnbmVkSW5WaWV3XCIpLmhpZGUoKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlQ3VycmVudFVzZXIoY3VycmVudFVzZXIpIHtcclxuICAgIHZhciBlbWFpbCA9IGN1cnJlbnRVc2VyLmlzU2lnbmVkSW4oKSA/IGN1cnJlbnRVc2VyLmdldEJhc2ljUHJvZmlsZSgpLmdldEVtYWlsKCkgOiBcIlwiO1xyXG4gICAgJChcIiNjdXJyZW50VXNlclwiKS50ZXh0KGVtYWlsKTtcclxufVxyXG5cclxuLy8tLS0tLSBMb2FkIERhdGEgLS0tLS0vL1xyXG5mdW5jdGlvbiBsb2FkRGF0YSgpIHtcclxuICAgIG9wZW5PdmVybGF5KFwiTG9hZGluZy4uLlwiKTtcclxuICAgIGlmIChERUJVRykge1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsb2FkSGFuZGxlYmFycyh7XHJcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmQ6IHNhbXBsZURhc2hib2FyZENvbnRleHQsXHJcbiAgICAgICAgICAgICAgICB0b2RheTogc2FtcGxlVG9kYXlDb250ZXh0LFxyXG4gICAgICAgICAgICAgICAgeWVzdGVyZGF5OiBzYW1wbGVZZXN0ZXJkYXlDb250ZXh0XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIERFTEFZKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgR29vZ2xlQVBJV3JhcHBlci5ydW5TY3JpcHQoXCJsb2FkRGF0YVwiLCBbX2N1cnJlbnRUaGVtZS5uYW1lXSwgbG9hZEhhbmRsZWJhcnMsIG9uRmFpbHVyZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vLS0tLS0gSGFuZGxlYmFycyBtZXRob2RzIC0tLS0tLy9cclxuZnVuY3Rpb24gbG9hZEhhbmRsZWJhcnMoZGF0YSkge1xyXG4gICAgZGlzcGxheVRlbXBsYXRlKFwiI2Rhc2hib2FyZC10ZW1wbGF0ZVwiLCBcIiNkYXNoYm9hcmRcIiwgZGF0YS5kYXNoYm9hcmQpO1xyXG4gICAgZGlzcGxheVRlbXBsYXRlKFwiI3RvZGF5LXRlbXBsYXRlXCIsIFwiI3RvZGF5XCIsIGRhdGEudG9kYXkpO1xyXG4gICAgZGlzcGxheVRlbXBsYXRlKFwiI3llc3RlcmRheS10ZW1wbGF0ZVwiLCBcIiN5ZXN0ZXJkYXlcIiwgZGF0YS55ZXN0ZXJkYXkpO1xyXG5cclxuICAgIGNsb3NlT3ZlcmxheSgpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gcmVnaXN0ZXJEYXlQYXJ0aWFsKCkge1xyXG4gICAgdmFyIHNjcmlwdCA9ICQoXCIjZGF5LXBhcnRpYWxcIikuaHRtbCgpO1xyXG4gICAgdmFyIHBhcnRpYWwgPSBIYW5kbGViYXJzLmNvbXBpbGUoc2NyaXB0KTtcclxuICAgIEhhbmRsZWJhcnMucmVnaXN0ZXJQYXJ0aWFsKFwiZGF5UGFydGlhbFwiLCBwYXJ0aWFsKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGRpc3BsYXlUZW1wbGF0ZSh0ZW1wbGF0ZUlkLCBzZWN0aW9uLCBjb250ZXh0KSB7XHJcbiAgICBpZiAoX0hhbmRsZWJhcnMudGVtcGxhdGVzW3RlbXBsYXRlSWRdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBfSGFuZGxlYmFycy50ZW1wbGF0ZXNbdGVtcGxhdGVJZF0gPSAkKHRlbXBsYXRlSWQpLmh0bWwoKTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgdGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoX0hhbmRsZWJhcnMudGVtcGxhdGVzW3RlbXBsYXRlSWRdKTtcclxuICAgIHZhciBodG1sID0gdGVtcGxhdGUoY29udGV4dCk7XHJcblxyXG4gICAgLy8gQWRkIHRoZSBjb21waWxlZCBodG1sIHRvIHRoZSBwYWdlXHJcbiAgICAkKHNlY3Rpb24pLmh0bWwoaHRtbCk7XHJcbn1cclxuXHJcbi8vLS0tLS0gT3ZlcmxheSBNZXRob2RzIC0tLS0tLy9cclxuZnVuY3Rpb24gb3Blbk92ZXJsYXkob3ZlcmxheVRleHQpIHtcclxuICAgICQoXCIjb3ZlcmxheS10ZXh0XCIpLnRleHQob3ZlcmxheVRleHQpO1xyXG4gICAgJChcIiN3YWl0XCIpLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VPdmVybGF5KCkge1xyXG4gICAgJChcIiN3YWl0XCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xyXG59XHJcblxyXG4vLy0tLS0tIEFkZCBOZXcgRW50cnkgRm9ybSBNZXRob2RzIC0tLS0tLy9cclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdChmb3JtT2JqZWN0KSB7XHJcbiAgICAkKCcjYWRkTmV3TW9kYWwnKS5tb2RhbCgnaGlkZScpO1xyXG5cclxuICAgIG9wZW5PdmVybGF5KFwiU2F2aW5nLi4uXCIpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKFwicnVubmluZyBzY3JpcHRcIik7XHJcblxyXG4gICAgdmFyIHZhbHVlcyA9IGdldEZvcm1WYWx1ZXMoZm9ybU9iamVjdCk7XHJcblxyXG4gICAgaWYgKCFERUJVRykge1xyXG4gICAgICAgIEdvb2dsZUFQSVdyYXBwZXIucnVuU2NyaXB0KFwic3VibWl0Rm9ybVwiLCB2YWx1ZXMsIG9uU3VibWl0Rm9ybVN1Y2Nlc3MsIG9uRmFpbHVyZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBvblN1Ym1pdEZvcm1TdWNjZXNzKCk7XHJcbiAgICAgICAgfSwgREVMQVkpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRGb3JtVmFsdWVzKGZvcm0pIHtcclxuICAgIHZhciAkaW5wdXRzID0gJCgnIycgKyBmb3JtLmlkICsgJyA6aW5wdXQnKTtcclxuXHJcbiAgICB2YXIgdmFsdWVzID0ge307XHJcbiAgICAkaW5wdXRzLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICgodGhpcy50eXBlID09PSBcInJhZGlvXCIgJiYgdGhpcy5jaGVja2VkID09PSB0cnVlKSB8fCAodGhpcy50eXBlICE9PSBcInJhZGlvXCIpKSB7XHJcbiAgICAgICAgICAgIHZhbHVlc1t0aGlzLm5hbWVdID0gJCh0aGlzKS52YWwoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YWx1ZXNbXCJiYWJ5XCJdID0gX2N1cnJlbnRUaGVtZS5uYW1lO1xyXG5cclxuICAgIGlmICh2YWx1ZXNbXCJmZWVkaW5nLXR5cGVcIl0gIT09IFwiU29saWRzXCIpIHtcclxuICAgICAgICBkZWxldGUgdmFsdWVzW1wibWVhbFwiXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodmFsdWVzW1wiZmVlZGluZy10eXBlXCJdICE9PSBcIkJvdHRsZVwiKSB7XHJcbiAgICAgICAgZGVsZXRlIHZhbHVlc1tcImFtb3VudFwiXTtcclxuICAgICAgICBkZWxldGUgdmFsdWVzW1widHlwZVwiXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodmFsdWVzW1wiZmVlZGluZy10eXBlXCJdICE9PSBcIkJyZWFzdFwiKSB7XHJcbiAgICAgICAgZGVsZXRlIHZhbHVlc1tcInRpbWVcIl07XHJcbiAgICAgICAgZGVsZXRlIHZhbHVlc1tcInNpZGVcIl07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2codmFsdWVzKTtcclxuXHJcbiAgICByZXR1cm4gdmFsdWVzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvbkZhaWx1cmUobWVzc2FnZSkge1xyXG4gICAgY2xvc2VPdmVybGF5KCk7XHJcbiAgICBhbGVydChtZXNzYWdlKTtcclxuICAgICQoXCIjc3VibWl0QnRuXCIpLnZhbChcIlN1Ym1pdFwiKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIG9uU3VibWl0Rm9ybVN1Y2Nlc3MoKSB7XHJcbiAgICAkKFwiI3N1Ym1pdEJ0blwiKS52YWwoXCJTdWJtaXRcIik7XHJcbiAgICBjbG9zZU92ZXJsYXkoKTtcclxuICAgIGxvYWREYXRhKCk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiByZXNldEZvcm0oKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcInJlc2V0Rm9ybVwiKTtcclxuXHJcbiAgICAvLyBnZXQgdGhlIGlzbyB0aW1lIHN0cmluZyBmb3JtYXR0ZWQgZm9yIHVzYWdlIGluIGFuIGlucHV0Wyd0eXBlPVwiZGF0ZXRpbWUtbG9jYWxcIiddXHJcbiAgICB2YXIgdHpvZmZzZXQgPSAobmV3IERhdGUoKSkuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwOyAvL29mZnNldCBpbiBtaWxsaXNlY29uZHNcclxuICAgIHZhciBsb2NhbElTT1RpbWUgPSAobmV3IERhdGUoRGF0ZS5ub3coKSAtIHR6b2Zmc2V0KSkudG9JU09TdHJpbmcoKS5zbGljZSgwLCAtMSk7XHJcbiAgICB2YXIgbG9jYWxJU09UaW1lV2l0aG91dFNlY29uZHMgPSBsb2NhbElTT1RpbWUuc2xpY2UoMCwgMTYpO1xyXG5cclxuICAgICQoXCIjZGF0ZVwiKS52YWwobG9jYWxJU09UaW1lLnNsaWNlKDAsIDE2KSk7XHJcblxyXG4gICAgLy8gcmVzZXQgY29udHJvbHNcclxuICAgICQoXCIjYW1vdW50XCIpLnZhbCgnJyk7XHJcbiAgICAkKFwiI3R5cGVcIikudmFsKCcnKTtcclxuICAgICQoXCIjdGltZVwiKS52YWwoJycpO1xyXG4gICAgJChcIiNtZWFsXCIpLnZhbCgnJyk7XHJcbiAgICAkKFwiI3ZpdGFtaW4tbm9cIikuY2xpY2soKTtcclxuICAgICQoXCIjd2V0LW5vXCIpLmNsaWNrKCk7XHJcbiAgICAkKFwiI2RpcnR5LW5vXCIpLmNsaWNrKCk7XHJcbiAgICAkKFwiI3dlaWdodFwiKS52YWwoJycpO1xyXG4gICAgJChcIiNub3Rlc1wiKS52YWwoJycpO1xyXG4gICAgJChcIiNiYXRoLW5vXCIpLmNsaWNrKCk7XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==